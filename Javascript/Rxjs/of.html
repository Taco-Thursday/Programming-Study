<!DOCTYPE html>
<html lang="en" >
<head>
  <meta charset="UTF-8">
  <title>RxJS  Demo</title>
</head>
<body>
<input type="text" id="ipt">
<ul id="list">

</ul>
</body>
<script src='./lib/Rx.umd.js'></script>
<script>
  // ?q=rxjs&sort=stars&order=desc
  const URL = `https://api.github.com/search/repositories`;

  function getRepo(keyword) {
    return fetch(`${URL}?q=${keyword}&sort=stars&order=desc`)
      .then(res => res.json())
  }

  function renderList(list) {
    listDom = document.querySelector('#list');
    listDom.innerHTML = '';
    listDom.innerHTML = list.map(item => `<li>${item.full_name}</li>`).join('');
  }

  // Create simple observable that emits three values
  const ipt$ = Rx.Observable.fromEvent(document.querySelector('#ipt'), 'input');

  ipt$
    .switchMap((e) => {
      return getRepo(e.target.value);
    },
      (e, res, eIndex, resIndex) => {
        return res.items
        console.log(e)
        console.log(res)
        console.log(eIndex)
        console.log(resIndex)
      })
    .subscribe(res => {
      renderList(res)
    });


</script>
</html>
